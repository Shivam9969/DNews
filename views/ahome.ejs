<!DOCTYPE html>
<html>
<head>
        <title>Admin Home Page</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js'></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin: 0;
  font-family: "Lato", sans-serif;
}

.sidebar {
  margin: 2;
  margin-top: 50px;
  padding: 0;
  width: 200px;
  background-color: #f1f1f1;
  position: fixed;
  height: 100%;
  overflow: auto;
}

.sidebar a {
  display: block;
  color: black;
  padding: 16px;
  text-decoration: none;
}
 
.sidebar a.active {
  background-color: #189AB4;
  color: white;
}

.sidebar a:hover:not(.active) {
  background-color:#189AB4;
  color: white;
}
.fa:hover{
    color: white;
}
div.content {
  margin-left: 200px;
  padding: 1px 16px;
  height: 1000px;
}

@media screen and (max-width: 700px) {
  .sidebar {
    width: 100%;
    height: auto;
    position: relative;
  }
  .sidebar a {float: left;}
  div.content {margin-left: 0;}
}

@media screen and (max-width: 400px) {
  .sidebar a {
    text-align: center;
    float: none;
  }
}
</style>

</head>
<body onload="getdata();">
    <nav class="navbar bg-info navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">DNews</a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
          <ul class="nav navbar-nav navbar-right">
            <li><a href=><span class="glyphicon glyphicon-user"></span>
                <%=name%>
              </a></li>
            <li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><span
                  class="glyphicon glyphicon-log-in"></span>More</a>
              <ul class="dropdown-menu">
                <li><a href="/">Logout</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

<div class="sidebar">
  <a class="active" href="/ahome"><i class="fa fa-home" style="font-size:20px;color:white"></i>&nbsp;&nbsp;Home</a>
  <a href="/ainbox"><i class="fa fa-inbox" style="font-size:20px;color:black"></i>&nbsp;&nbsp;Inbox</a>
  <a href="/astock"><i class="fa fa-area-chart" style="font-size:20px;color:black"></i>&nbsp;&nbsp;Stock</a>
  <a href="/ausrdetail"><i class="fa fa-folder" style="font-size:20px;color:black"></i>&nbsp;&nbsp;UserDeatails</a>
</div>
  <div class="content"><br><br><br><br>
    <div class="panel panel-primary">
      <div class="panel-heading">Papers Requests</div>
          <div class="panel-body bg-warning">
               <canvas id="chart" width="auto" height="400"></canvas>
          </div>
        </div>
  <% if(userData.length!=0){ var i=1; userData.forEach(function(data){ %>
    <div class="panel panel-primary">
      <div class="panel-heading">Tabular DATA
      </div>
      <div class="panel-body bg-warning">
        <table border="1" class="table" id="myinput">
          <tr>
            <th>
              PaperType
            </th>
            <th>
              Requests Completed
            </th>
            <th>
              Total Money Recived
            </th>
          </tr>
          <tr>
            <td>
              <%=data.note%>
            </td>
            <td>
              <%=data.count%>
            </td>
            <td>
              <% if(data.note==="MM")
                { %>
                  <%=data.count*8%>
              <% } %>
              <% if(data.note==="TOI" ) { %>
                <%=data.count*10%>
              <% } %>
              <% if(data.note==="TIE" ) { %>
                <%=data.count*10%>
              <% } %>
              <% if(data.note==="NBT" ) { %>
                <%=data.count*3%>
              <% } %>
              <% if(data.note==="HT" ) { %>
                <%=data.count*5%>
              <% } %>
            </td>
          </tr>
        </table>
        <br>
      </div>
    </div>
  
    <% i++; }) %>
      <% } else{ %>
        <div class="panel panel-primary">
          <div class="panel-heading">Request &nbsp;&nbsp;</div>
          <div class="panel-body">
            <p>No Data Found</p>
          </div>
        </div>
        <% } %>
  </div>
  <script>
    // bar chart data  
    function getdata(){
      var chk='<%-JSON.stringify(userData)%>'
      var b=JSON.parse(chk);
      var c=[];
      var d=[];
      console.log(b.length);
      console.log("abcd")
      console.log(b.map(n => n));
      $.each(b.map(n => n), function () {
        var key1 = Object.keys(this)[0];
        var value1 = this[key1];

        var key2 = Object.keys(this)[1];
        var value2 = this[key2];
        c.push(value1);
        d.push(value2);
      });
      //console.log(c.map(n => n * 1));
      
      var barData = {
        
          labels:c,
          datasets: [{
          fillColor: "rgba(217, 30, 24,1)",
          strokeColor: "rgba(217, 30, 24,1)",
          pointColor: "rgba(217, 30, 24,1)",
          data: d
        }
        ]
      }

      // get bar chart canvas
      var mychart = document.getElementById("chart").getContext("2d");

      steps = 15
      max = 100

      // draw bar chart
      new Chart(mychart).Bar(barData, {
        scaleOverride: true,
        scaleSteps: steps,
        scaleStepWidth: Math.ceil(max / steps),
        scaleStartValue: 0,
        scaleShowVerticalLines: true,
        scaleShowGridLines: true,
        barShowStroke: true,
        scaleShowLabels: true
      }
      );
    }
  </script>
</body>
</html>
